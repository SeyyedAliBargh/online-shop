<!--

üìÑ Template: shop/product_detail.html
üîó View: product_detail(request, slug)
üéØ Purpose: ŸÜŸÖÿß€åÿ¥ ÿ¨ÿ≤ÿ¶€åÿßÿ™ €å⁄© ŸÖÿ≠ÿµŸàŸÑÿå ŸáŸÖÿ±ÿßŸá ÿ®ÿß ŸÜÿ∏ÿ±ÿßÿ™ÿå ÿßŸÖÿ™€åÿßÿ≤ÿå Ÿà ŸÖÿ≠ÿµŸàŸÑÿßÿ™ ŸÖÿ±ÿ™ÿ®ÿ∑.

‚úÖ ÿØÿ± ÿß€åŸÜ ÿ™ŸÖŸæŸÑ€åÿ™ÿå ŸÖŸÇÿßÿØ€åÿ± ÿ≤€åÿ± ÿßÿ≤ view ÿßÿ±ÿ≥ÿßŸÑ ŸÖ€å‚Äåÿ¥ŸàŸÜÿØ:

‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
üß± 1Ô∏è‚É£ product  ‚Üí ÿßÿ≤ ŸÖÿØŸÑ Product
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
ÿØÿßÿ±ÿß€å ŸÅ€åŸÑÿØŸáÿß€å ÿ≤€åÿ± ÿßÿ≥ÿ™:
    ‚Ä¢ product.id ‚Üí ÿ¥ŸÜÿßÿ≥Ÿá ŸÖÿ≠ÿµŸàŸÑ
    ‚Ä¢ product.name ‚Üí ŸÜÿßŸÖ ŸÖÿ≠ÿµŸàŸÑ
    ‚Ä¢ product.slug ‚Üí ÿßÿ≥ŸÑÿß⁄Ø (ÿ®ÿ±ÿß€å URL)
    ‚Ä¢ product.category ‚Üí ÿ¥€åÿ° ŸÖÿ±ÿ®Ÿàÿ∑ ÿ®Ÿá Category (ÿØÿ≥ÿ™Ÿá‚Äåÿ®ŸÜÿØ€å)
        ‚îî‚îÄ‚îÄ product.category.name ‚Üí ŸÜÿßŸÖ ÿØÿ≥ÿ™Ÿá
    ‚Ä¢ product.description ‚Üí ÿ™Ÿàÿ∂€åÿ≠ÿßÿ™ ŸÖÿ≠ÿµŸàŸÑ
    ‚Ä¢ product.brand ‚Üí ÿ®ÿ±ŸÜÿØ (ŸÖŸÖ⁄©ŸÜ ÿßÿ≥ÿ™ ÿÆÿßŸÑ€å ÿ®ÿßÿ¥ÿØ)
    ‚Ä¢ product.weight ‚Üí Ÿàÿ≤ŸÜ ŸÖÿ≠ÿµŸàŸÑ (⁄Øÿ±ŸÖ)
    ‚Ä¢ product.original_price ‚Üí ŸÇ€åŸÖÿ™ ÿßÿµŸÑ€å
    ‚Ä¢ product.discount ‚Üí ÿØÿ±ÿµÿØ ÿ™ÿÆŸÅ€åŸÅ (ÿßÿÆÿ™€åÿßÿ±€å)
    ‚Ä¢ product.discounted_price ‚Üí ŸÇ€åŸÖÿ™ ÿ®ÿπÿØ ÿßÿ≤ ÿ™ÿÆŸÅ€åŸÅ
    ‚Ä¢ product.views ‚Üí ÿ™ÿπÿØÿßÿØ ÿ®ÿßÿ≤ÿØ€åÿØŸáÿß
    ‚Ä¢ product.sold_count ‚Üí ÿ™ÿπÿØÿßÿØ ŸÅÿ±Ÿàÿ¥
    ‚Ä¢ product.average_rating ‚Üí ŸÖ€åÿßŸÜ⁄Ø€åŸÜ ÿßŸÖÿ™€åÿßÿ≤ (ÿπÿØÿØ ÿ®€åŸÜ 0 ÿ™ÿß 5)
    ‚Ä¢ product.rating_count ‚Üí ÿ™ÿπÿØÿßÿØ ÿßŸÅÿ±ÿßÿØ€å ⁄©Ÿá ÿßŸÖÿ™€åÿßÿ≤ ÿØÿßÿØŸá‚ÄåÿßŸÜÿØ
    ‚Ä¢ product.get_absolute_url ‚Üí ÿ¢ÿØÿ±ÿ≥ ÿ¨ÿ≤ÿ¶€åÿßÿ™ ŸÖÿ≠ÿµŸàŸÑ

    üîπ ÿßÿ±ÿ™ÿ®ÿßÿ∑‚ÄåŸáÿß:
    ‚Ä¢ product.images.all ‚Üí ŸÑ€åÿ≥ÿ™ ÿ™ÿµÿßŸà€åÿ± ŸÖÿ≠ÿµŸàŸÑ (ŸÖÿØŸÑ Image)
        ‚ñ´ image.image_file.url ‚Üí ŸÖÿ≥€åÿ± ÿπ⁄©ÿ≥
        ‚ñ´ image.title ‚Üí ÿπŸÜŸàÿßŸÜ ÿπ⁄©ÿ≥
        ‚ñ´ image.description ‚Üí ÿ™Ÿàÿ∂€åÿ≠ ÿπ⁄©ÿ≥

    ‚Ä¢ product.features.all ‚Üí Ÿà€å⁄ò⁄Ø€å‚ÄåŸáÿß€å ŸÖÿ≠ÿµŸàŸÑ (ŸÖÿØŸÑ ProductFeature)
        ‚ñ´ feature.name ‚Üí ŸÜÿßŸÖ Ÿà€å⁄ò⁄Ø€å (ŸÖÿ´ŸÑÿßŸã ¬´Ÿàÿ≤ŸÜ¬ªÿå ¬´ŸÜŸàÿπ ÿ®ÿ≥ÿ™Ÿá‚Äåÿ®ŸÜÿØ€å¬ª)
        ‚ñ´ feature.value ‚Üí ŸÖŸÇÿØÿßÿ± Ÿà€å⁄ò⁄Ø€å

    ‚Ä¢ product.comments.all ‚Üí ŸÑ€åÿ≥ÿ™ ÿ™ŸÖÿßŸÖ ŸÜÿ∏ÿ±ÿßÿ™ ŸÖÿ≠ÿµŸàŸÑ (ŸÖÿØŸÑ Comment)

‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
üß© 2Ô∏è‚É£ related_product ‚Üí QuerySet ÿßÿ≤ ŸÖÿØŸÑ Product
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
ŸÖÿ≠ÿµŸàŸÑÿßÿ™ ŸÖÿ¥ÿßÿ®Ÿá ⁄©Ÿá ÿØÿ± ŸáŸÖÿßŸÜ ÿØÿ≥ÿ™Ÿá Ÿáÿ≥ÿ™ŸÜÿØ (ÿ®ÿ¨ÿ≤ ŸÖÿ≠ÿµŸàŸÑ ŸÅÿπŸÑ€å)ÿå ŸÖÿ≠ÿØŸàÿØ ÿ®Ÿá €≥ ÿπÿØÿØ.
    ‚ñ´ Ÿáÿ± ŸÖŸàÿ±ÿØ ŸÖÿ¥ÿßÿ®Ÿá ÿ™ŸÖÿßŸÖ ŸÅ€åŸÑÿØŸáÿß€å product ÿ±ÿß ÿØÿßÿ±ÿØ (name, slug, image, price, ...)

‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
üí¨ 3Ô∏è‚É£ comments ‚Üí QuerySet ÿßÿ≤ ŸÖÿØŸÑ Comment
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
ŸÅŸÇÿ∑ ŸÜÿ∏ÿ±ÿßÿ™ ÿ≥ÿ∑ÿ≠ ÿßŸàŸÑ (parent__isnull=True)
    ‚ñ´ comment.user ‚Üí ⁄©ÿßÿ±ÿ®ÿ±€å ⁄©Ÿá ŸÜÿ∏ÿ± ÿØÿßÿØŸá
        ‚îî‚îÄ‚îÄ comment.user.username ‚Üí ŸÜÿßŸÖ ⁄©ÿßÿ±ÿ®ÿ±
    ‚ñ´ comment.body ‚Üí ŸÖÿ™ŸÜ ŸÜÿ∏ÿ±
    ‚ñ´ comment.created ‚Üí ÿ™ÿßÿ±€åÿÆ ÿßÿ±ÿ≥ÿßŸÑ ŸÜÿ∏ÿ±
    ‚ñ´ comment.replies.all ‚Üí Ÿæÿßÿ≥ÿÆ‚ÄåŸáÿß ÿ®Ÿá ŸáŸÖÿßŸÜ ŸÜÿ∏ÿ±

‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
‚≠ê 4Ô∏è‚É£ rating_percent ‚Üí ŸÖŸÇÿØÿßÿ± ÿπÿØÿØ€å (€∞ ÿ™ÿß €±€∞€∞)
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
ÿØÿ±ÿµÿØ ÿ™ÿ®ÿØ€åŸÑ‚Äåÿ¥ÿØŸá ÿßÿ≤ ŸÖ€åÿßŸÜ⁄Ø€åŸÜ ÿßŸÖÿ™€åÿßÿ≤ ŸÖÿ≠ÿµŸàŸÑ ÿ®ÿ±ÿß€å ÿßÿ≥ÿ™ŸÅÿßÿØŸá ÿØÿ± progress bar €åÿß ÿ≥ÿ™ÿßÿ±Ÿá‚ÄåŸáÿß.
    ‚ñ´ ŸÖÿ≠ÿßÿ≥ÿ®Ÿá‚Äåÿ¥ÿØŸá ÿ®Ÿá‚ÄåÿµŸàÿ±ÿ™: (average_rating / 5) * 100

‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
üßç 5Ô∏è‚É£ user_rating ‚Üí ÿπÿØÿØ €åÿß None
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
ÿß⁄Øÿ± ⁄©ÿßÿ±ÿ®ÿ± Ÿàÿßÿ±ÿØ ÿ≥€åÿ≥ÿ™ŸÖ ÿ¥ÿØŸá ÿ®ÿßÿ¥ÿØ Ÿà ŸÇÿ®ŸÑÿßŸã ÿßŸÖÿ™€åÿßÿ≤ ÿØÿßÿØŸá ÿ®ÿßÿ¥ÿØÿå ÿπÿØÿØ€å ÿ®€åŸÜ €± ÿ™ÿß €µ ÿØÿßÿ±ÿØ.
ÿØÿ± ÿ∫€åÿ± ÿß€åŸÜÿµŸàÿ±ÿ™ ŸÖŸÇÿØÿßÿ± None ÿßÿ≥ÿ™.
    ‚ñ´ ŸÇÿßÿ®ŸÑ ÿßÿ≥ÿ™ŸÅÿßÿØŸá ÿ®ÿ±ÿß€å ŸÜŸÖÿß€åÿ¥ Ÿàÿ∂ÿπ€åÿ™ ÿ≥ÿ™ÿßÿ±Ÿá‚ÄåŸáÿß ÿ®ÿ±ÿß€å ⁄©ÿßÿ±ÿ®ÿ±.

‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
üóíÔ∏è 6Ô∏è‚É£ form ‚Üí ŸÜŸÖŸàŸÜŸá ÿßÿ≤ CommentForm
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
ŸÅÿ±ŸÖ€å ÿ®ÿ±ÿß€å ÿßÿ±ÿ≥ÿßŸÑ ŸÜÿ∏ÿ± ÿ¨ÿØ€åÿØ.
    ‚ñ´ ÿ¥ÿßŸÖŸÑ ŸÅŸÇÿ∑ €å⁄© ŸÅ€åŸÑÿØ:
        ‚Ä¢ form.body ‚Üí ŸÅ€åŸÑÿØ ŸÖÿ™ŸÜ ŸÜÿ∏ÿ±

‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
üí° ŸÜ⁄©ÿßÿ™ Ÿæ€åÿ¥ŸÜŸáÿßÿØ€å ÿ®ÿ±ÿß€å ŸÅÿ±ÿßŸÜÿ™:
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
- ÿßÿ≤ product.images.first ÿ®ÿ±ÿß€å ŸÜŸÖÿß€åÿ¥ ÿ™ÿµŸà€åÿ± ÿßÿµŸÑ€å ÿßÿ≥ÿ™ŸÅÿßÿØŸá ⁄©ŸÜ.
- ÿßÿ≤ related_product ÿ®ÿ±ÿß€å ŸÜŸÖÿß€åÿ¥ ¬´ŸÖÿ≠ÿµŸàŸÑÿßÿ™ ŸÖÿ¥ÿßÿ®Ÿá¬ª ÿØÿ± ÿßŸÜÿ™Ÿáÿß€å ÿµŸÅÿ≠Ÿá.
- ÿßÿ≤ rating_percent ÿ®ÿ±ÿß€å ŸÜŸÖÿß€åÿ¥ ÿØÿ±ÿµÿØ Ÿæÿ± ÿ¥ÿØŸÜ ÿ≥ÿ™ÿßÿ±Ÿá‚ÄåŸáÿß.
- ÿßÿ≤ user_rating ÿ®ÿ±ÿß€å ŸÜŸÖÿß€åÿ¥ ÿ≥ÿ™ÿßÿ±Ÿá‚ÄåŸáÿß€å ÿßŸÜÿ™ÿÆÿßÿ®‚Äåÿ¥ÿØŸá ⁄©ÿßÿ±ÿ®ÿ± ÿØÿ± ÿ®ÿÆÿ¥ ÿßŸÖÿ™€åÿßÿ≤ÿØŸá€å.
- ÿßÿ≤ form ÿ®ÿ±ÿß€å ÿß€åÿ¨ÿßÿØ textarea Ÿà ÿØ⁄©ŸÖŸá ÿßÿ±ÿ≥ÿßŸÑ ŸÜÿ∏ÿ±.
- ÿßÿ≤ comments ÿ®ÿ±ÿß€å ÿ≥ÿßÿÆÿ™ ÿ®ÿÆÿ¥ ŸÜÿ∏ÿ±ÿßÿ™ Ÿà Ÿæÿßÿ≥ÿÆ‚ÄåŸáÿß.


 -->


{% extends 'parent/base.html' %}
{% load static %}

{% block title %}{{ product.name }}{% endblock %}

{% block content %}
<div class="container mt-5">
    <div class="row">
        <!-- Product Information -->
        <div class="col-md-6">
            <img src="{{ product.images.first.image_file.url }}" alt="{{ product.name }}" class="img-fluid rounded">
        </div>

        <div class="col-md-6">
            <h2>{{ product.name }}</h2>
            <p class="text-muted">{{ product.category.name }}</p>
            <p>{{ product.description }}</p>
            <p><strong>Price:</strong> {{ product.discounted_price }} ÿ™ŸàŸÖÿßŸÜ</p>
            <p><strong>Rating:</strong> {{ product.average_rating }} / 5 ({{ product.rating_count }} votes)</p>

            <!-- Rating Section -->
            <div class="rating-section mt-4">
                <h5>Rate this product</h5>

                {% if user.is_authenticated %}
                <form id="ratingForm" method="POST">
                    {% csrf_token %}
                    <div class="rating-stars" id="starContainer">
                        {% for i in "12345" %}
                        <span class="star" data-value="{{ forloop.counter }}">‚≠ê</span>
                        {% endfor %}
                    </div>
                    <input type="hidden" name="score" id="scoreInput">
                    <button type="submit" class="btn btn-primary mt-3">Submit Rating</button>
                </form>
                <div id="ratingMessage" class="mt-3"></div>


                {% else %}
                <p class="text-danger mt-2">
                    Please <a href="{% url 'account:login' %}">login</a> to rate this product.
                </p>
                {% endif %}
            </div>
        </div>
    </div>
</div>

<!-- Ajax Script -->
<script>
document.addEventListener('DOMContentLoaded', function() {
    const form = document.getElementById('ratingForm');
    const stars = document.querySelectorAll('.star');
    const scoreInput = document.getElementById('scoreInput');
    const messageBox = document.getElementById('ratingMessage');
    let selectedRating = 0;

    // ‚≠ê ŸàŸÇÿ™€å ÿ±Ÿà€å €å⁄© ÿ≥ÿ™ÿßÿ±Ÿá ⁄©ŸÑ€å⁄© ŸÖ€å‚Äå⁄©ŸÜ€å
    stars.forEach(star => {
        star.addEventListener('click', () => {
            selectedRating = parseInt(star.dataset.value);
            scoreInput.value = selectedRating;
            updateStars(selectedRating);
        });

        star.addEventListener('mouseover', () => {
            updateStars(parseInt(star.dataset.value));
        });

        star.addEventListener('mouseleave', () => {
            updateStars(selectedRating);
        });
    });

    // ÿ™ÿßÿ®ÿπ ÿ®ÿ±ÿß€å ÿ¢ŸæÿØ€åÿ™ ÿ∏ÿßŸáÿ± ÿ≥ÿ™ÿßÿ±Ÿá‚ÄåŸáÿß
    function updateStars(rating) {
        stars.forEach(star => {
            if (parseInt(star.dataset.value) <= rating) {
                star.classList.add('active');
            } else {
                star.classList.remove('active');
            }
        });
    }

    // ÿßÿ±ÿ≥ÿßŸÑ AJAX
    form.addEventListener('submit', async function(e) {
        e.preventDefault();
        if (!scoreInput.value) {
            messageBox.innerHTML = '<div class="text-warning">Please select a rating first.</div>';
            return;
        }

        try {
            const response = await fetch("{% url 'shop:rate_product' product.id %}", {
                method: 'POST',
                headers: {
                    'X-CSRFToken': '{{ csrf_token }}',
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({ score: scoreInput.value })
            });

            const data = await response.json();

            if (data.success) {

                messageBox.innerHTML = `
                    <div class="text-success">
                        ‚úÖ Rating submitted successfully! <br>
                        Average: ${data.average.toFixed(1)} / 5 (${data.count} votes)
                    </div>`;
            } else {
                messageBox.innerHTML = `<div class="text-danger">Error: ${data.error}</div>`;
            }

        } catch (error) {
            messageBox.innerHTML = '<div class="text-danger">Something went wrong. Please try again later.</div>';
        }
    });
});
</script>

<!-- ‚≠ê Style -->
<style>
.rating-stars {
    display: flex;
    gap: 10px;
    flex-direction: row;
    justify-content: start;
}

.star {
    font-size: 2.5rem;
    color: #ddd;
    cursor: pointer;
    transition: color 0.2s;
}

.star.active {
    color: #f39c12;
}

.star:hover {
    transform: scale(1.1);
}
</style>

{% endblock %}
